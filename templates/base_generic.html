<!DOCTYPE html>
<html lang="en">
<head>
    {% block title %}<title>ASQ - MMNIT's Q&A Forum</title>{% endblock %}
    {% load static %}

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="ask about mnnit " >
    <meta name="author" content="no one">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <!-- <link href="{% static 'bs4/bootstrap.min.css' %}" rel="stylesheet" type="text/css">
    <script src="{% static 'bs4/bootstrap.min.css' %}"></script> -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU"
      crossorigin="anonymous">
    <link href="{% static 'asq_project/froala_editor/css/froala_editor.min.css' %}" type="text/css" media="all" rel="stylesheet" />
    <link href="{% static 'asq_project/froala_editor/css/froala_style.min.css' %}" type="text/css" media="all" rel="stylesheet" />
    
    <script src="{% static 'asq_project/froala_editor/js/froala_editor.min.js' %}"></script>
    <link rel="stylesheet" type="text/css" href="{% static 'vendor/easy-ac/easy-autocomplete.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'vendor/easy-ac/easy-autocomplete.themes.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'vendor/easy-ac/easy-autocomplete.themes.min.css.map' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'vendor/easy-ac/easy-autocomplete.themes.min.css.map' %}">
    <script src="{% static 'vendor/easy-ac/jquery.easy-autocomplete.min.js' %}"></script>

    <script>
        function getCookie(cname) {
            var name = cname + "=";
            var ca = document.cookie.split(';');
            for (var i = 0; i < ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0) == ' ') c = c.substring(1);
                if (c.indexOf(name) == 0)
                    return c.substring(name.length, c.length);
            }
            return "";
        }
        $(function () {
            querybox.easyAutocomplete(options);
          });
    </script>

     <link rel="stylesheet" type="text/css" href="{% static 'asq_project/tagInput.css' %}">
      <script src="{% static 'asq_project/tagInput.js' %}"></script>
      <!-- Custom styles for this template -->
      <link href="{% static 'css/blog-home.css' %}" rel="stylesheet">

    <style>
      hr
      {
          margin:0px;
      }
      p{
        margin:6px;
      }
      body{
        /* background-image: url("{% static '/asq_project/images/back2.jpg' %}"); */
        background-color: #f1f2e3;
      }
    </style>
</head>

<body >


    <!-- Navigation -->
  <div class="container">

      <nav class="navbar navbar-expand-md bg-dark navbar-dark fixed-top">

        <a class="navbar-brand" href="/q">asq MNNIT</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <p>&nbsp;&nbsp;</p>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav  mr-auto">
            <!-- search bar -->
             <li class="nav-item">
                <div class="input-group">
                  <input type="text" class="form-control" id="qbox" placeholder="Search">
                  <div class="input-group-append">
                    <button class="btn btn-primary" onclick="open_search()"  type="submit"><i class="fas fa-search"></i></button>
                  </div>
                </div>
            </li>
            <p>&nbsp;&nbsp;</p>
            <li class="nav-item active">
              <a class="nav-link" href="/q"><i class="fas fa-home"> </i> Home
                <span class="sr-only">(current)</span>
              </a>
            </li>
            <p>&nbsp;&nbsp;</p>
            {% if user.is_authenticated %}
              <li class="nav-item">
                <a class="nav-link" data-toggle="modal" data-target="#myModal" onclick="get_new_notification()" style="cursor: pointer;"><i class="fas fa-bell"> </i> Notifications</a>
              </li>
              <p>&nbsp;&nbsp;</p>
              <li class="nav-item">
                <a class="nav-link" href="{% url 'user_dashboard' %}"><i class="fas fa-user"></i> {{ user.username }}</a>
              </li>
              <p>&nbsp;&nbsp;</p>
              <li class="nav-item">
                <a class="nav-link" href="{% url 'logout' %}"> <i class="fas fa-sign-out-alt"></i> Logout</a>
              </li>
              <p>&nbsp;&nbsp;</p>
             {% else %}
              <li class="nav-item">
                <a class="nav-link" href="/accounts/login"><i class="fas fa-sign-in-alt"></i> Login</a>
              </li>
              <p>&nbsp;&nbsp;</p>
              <li class="nav-item">
                <a class="nav-link" href="/accounts/signup"><i class="fas fa-user-plus"></i> Signup</a>
              </li>
              <p>&nbsp;&nbsp;</p>
            {% endif %}
            <li class="nav-item">
              <a class="nav-link" href="#" data-toggle="modal" data-target="#myModalcontact"> <i class="fas fa-address-book"></i> Contact</a>
            </li>
            <p>&nbsp;&nbsp;</p>
          </ul>
        </div>  
      </nav>
  </div>
     {% block sidebar %}
    <!-- insert default navigation text for every page -->
    {% endblock %}

    {% block content %}
    <!-- default content text (typically empty) -->
    {% endblock %}

    <footer >     
      <hr><br><br><div  style="background-color:black;color:white  "><br><br><center>(c) 2018 Team django-unchained Webster 2018</center> <br></div></footer>
 <!-- 
    <script src="{% static 'vendor/bootstrap/js/bootstrap.min.js' %}"></script>
    <link rel="stylesheet" type="text/css" href="{% static 'vendor/bootstrap/css/bootstrap.min.css' %}">

<!-- <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">Open Modal</button>
 -->
<!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">New Notifications</h4>
      </div>
      <div class="modal-body">
        <p></p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal" onclick='$(".modal-body").text("");' >Close</button>
      </div>
    </div>

  </div>
</div>

<div id="myModalcontact" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Django-Unchained</h4>
      </div>
      <div class="modal-body">
        <p>
          <h5>Our Team</h5><br><br><span>Tuhin Subhra Patra</span><br>
        <span>Milan Bavishi</span><br>
      <span>Jugta Ram</span><br></p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal" onclick='$(".modal-body").text("");' >Close</button>
      </div>
    </div>

  </div>
</div>


  <script>
function get_new_notification(){
    $(".modal-body").text("");
   // console.log("fg");
    var tag= $("#tag").val();
    $.ajax({
        url: '/q/notification_route/',
        data: {
        },
        dataType: 'json',
        success: function (data) {
            if(data){
              received_ans=JSON.parse(data.notify_serialized);
               console.log(received_ans);
               console.log(data);
               received_comment=JSON.parse(data.notify_serialize);
               console.log(received_comment);
               //author_list=JSON.parse(data);
               for(var i=0;i<received_ans.length;i++)
              if(received_ans)
               $(".modal-body").append("user <a href=/u/"+received_ans[i].fields.author+">"+data.author[i]+"</a>commented on your question<a href="+'/q/'+received_ans[i].pk+"/"+received_ans[i].fields.slug+" onclick='notification_answer_update("+received_ans[i].pk+");'"+">"+received_ans[i].fields.title+"</a><br>");
               // ///alert("new notification received");
               for(var i=0;i<received_comment.length;i++)
               if(received_comment)
               $(".modal-body").append("user <a href=/u/"+received_comment[i].fields.author+">"+data.author[i]+"</a> answered your question <a href="+'/q/'+received_comment[i].pk+"/"+received_comment[i].fields.slug+" onclick='notification_comment_update("+received_comment[i].pk+");'"+">"+received_comment[i].fields.title+"</a><br>");
               // ///alert("new notification received");

               }
       
   }
      });
    }


  function notification_comment_update(qid) {
            //alert(qid);
            $.ajax({
              url: '/q/delete_comment_notification/',
              data: {
                  'qid':qid
              },
              dataType: 'json',
              success: function (data) {
                  if(data){
                    alert("okk" +data);
                }
            
        }
            });
          // body...
      }

function notification_answer_update(qid) {
           // alert(qid);
            $.ajax({
              url: '/q/delete_answer_notification/',
              data: {
                  'qid':qid
              },
              dataType: 'json',
              success: function (data) {
                  if(data){
                    alert("okk" +data);
                }
            
        }
            });
          // body...
      }


  let querybox = $('#qbox');
  function open_search() {
    window.location = "/search/?q=" + querybox.val();
  }

  var options = {

    url: function (phrase) {
      return '/q/search/?q=' + phrase;
    },
    getValue: "title",
    template: {
      type: "links",
      fields: {
        link: "website-link"
      }
    },

    list: {
      match: {
        enabled: true
      },
      showAnimation: {
        type: "slide", //normal|slide|fade
        time: 400,
        callback: function () { }
      },

      hideAnimation: {
        type: "slide", //normal|slide|fade
        time: 400,
        callback: function () { }
      },
    },
    placeholder: "Search...",
    theme: "blue-light"
  };

  querybox.keydown(function (e) {
    if (e.keyCode == 13) {
      // alert(querybox.val());
      open_search();
      // function notification_update(qid) {
      //       ///alert(qid);
      //       $.ajax({
      //         url: '/q/delete_notification/',
      //         data: {
      //             'qid':qid
      //         },
      //         dataType: 'json',
      //         success: function (data) {
      //             if(data){
      //               alert("okk" +data);
      //           }
            
      //   }
      //       });
      //     // body...
      // }
    }
  } 
);

</script>


</body>

</html>