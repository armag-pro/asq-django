{% extends "base_generic.html" %}

{% block content %}

{% load static %}
<script src="{% static 'vendor/jqcloud.min.js' %}"></script>
<link rel="stylesheet" type="text/css" href="{% static 'vendor/jqcloud.min.css' %}">

{% if latest_question_list %}
    <div class="container">
        <div class="row">
            <div class="col-md-8 col-sm-12">
                <div class="row">
                    <div class="col-md-12 col-sm-12">
                        <h4 class="my-4" style="float:left">Latest Questions</h4 >
                        {% if user.is_authenticated %}
                            <button type="button" style="float:right;margin-top: 24px;" class="btn btn-primary active" onclick="changePage()">Add Question</button>
                        {% else %}
                            <button type="button" style="float:right;margin-top: 24px;cursor: not-allowed;" class="btn btn-primary disabled" >Add Question</button>
                        {% endif %}
                    </div>
                </div>
                {% for question in latest_question_list %}
                <div class="card mb-4">
                    <!-- <img class="card-img-top" src="http://placehold.it/750x300" alt="Card image cap"> -->
                    <div class="card-body">
                        <h5 class="card-title"><a href="{% url 'asq_app:question_detail' question.slug %}">{{ question.title }}</a></h5>
                        <!-- <br> -->
                        modified on {{ question.created_on }}
                        <i class="fas fa-user"></i> by {{ question.author.username }}
                        <i class="fas fa-pen-alt"></i> {{ question.answers.all.count }} answers
                    </div>
                </div>
                {% endfor %}

            </div>
            <!-- @@ col-md-8 div end @@ -->

            <div class="col-md-4 col-sm-12">
            
                <!-- Search Widget -->
                <div class="card my-4">
                    <h5 class="card-header">Tag Search</h5>
                    <div class="card-body">
                        <div class="input-group">
                            <input type="text" id="tag" class="form-control" placeholder="Search by tags...">
                            <span class="input-group-btn">
                                <button class="btn btn-secondary" onclick="tag_fliter()" type="button">Go!</button>
                            </span>
                        </div>
                    </div>
                    <div class="card-footer text-muted" id="tag_fliter_content"></div>
                </div>
            
                <!-- Categories Widget -->
                <div class="card my-4">
                    <h5 class="card-header">Top Tags</h5>
                    <div class="card-body">
                        <div id="tagcloud">
                            
                        </div>
                       
                    </div>
                </div>
            
                <!-- Side Widget -->
                <!-- <div class="card my-4">
                    <h5 class="card-header">Side Widget</h5>
                    <div class="card-body">
                        You can put anything you want inside of these side widgets. They are easy to use, and feature the new
                        Bootstrap 4 card containers!
                    </div>
                </div> -->
            </div>
            <!-- @@ col-md-4 div end @@ -->
        </div>
        <!-- @@ row div end @@ -->
    </div>
    <!-- @@ container div end @@ -->
{% else %}
<p>No Questions are available.</p>
{% endif %}

<script>
function tag_fliter(){
    var tag= $("#tag").val();
    $.ajax({
        url: '/q/tag_route/',
        data: {
          'tag':tag
        },
        dataType: 'json',
        success: function (data) {
        	if(data.question.length == 0){
        		txt="No Question Found";
        	}
          else if (data){
          	txt=""
          	for(var i=0;i<(data.question).length;i++)
          		txt+="<a href="+data.question[i]+">"+data.question_title[i]+"</a><br>"
          }
          	$("#tag_fliter_content").html("<p>"+txt+"</p>")
           
       
   }
      });
    }
    

    function changePage(){
        window.location="/q/ask/";
    }

    $(function ($) {
            let words = [
                { text: "Lorem", weight: 13, link: 'http://github.com/mistic100/jQCloud' },
                { text: "Ipsum", weight: 10.5, link: 'http://www.strangeplanet.fr' },
                { text: "Dolor", weight: 9.4, link: 'http://piwigo.org' },
                { text: "Sit", weight: 8 },
                { text: "Amet", weight: 6.2 },
                { text: "Consectetur", weight: 5 },
                { text: "Adipiscing", weight: 5 },
                { text: "Lorem", weight: 13, link: 'http://github.com/mistic100/jQCloud' },
                { text: "Ipsum", weight: 10.5, link: 'http://www.strangeplanet.fr' },
                { text: "Dolor", weight: 9.4, link: 'http://piwigo.org' },
                { text: "Sit", weight: 8 },
                { text: "Amet", weight: 6.2 },
                { text: "Consectetur", weight: 5 },
                { text: "Adipiscing", weight: 5 },
                { text: "Lorem", weight: 13, link: 'http://github.com/mistic100/jQCloud' },
                { text: "Ipsum", weight: 10.5, link: 'http://www.strangeplanet.fr' },
                { text: "Dolor", weight: 9.4, link: 'http://piwigo.org' },
                { text: "Sit", weight: 8 },
                { text: "Amet", weight: 6.2 },
                { text: "Consectetur", weight: 5 },
                { text: "Adipiscing", weight: 5 },
            ];
            $('#tagcloud').jQCloud(words, {
                width: 400,
                height: 400,
                center: {x:0.4,y:0.4},
                delay: 40,
                shape: 'rectangular'
            });

        });
</script>


{% endblock %}