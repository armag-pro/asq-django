{% extends "base_generic.html" %}

{% block content %}

<h1>title{{ qdata.title }}</h1>
<em>by -{{ qdata.author }}</em>
<p> tag--{{ qdata.tag }}</p>
<p> body--{{ qdata.body }}</p>
<h1>comments</h1>
{% for comment in qdata.comments.all %}
       <p>{{comment.commentbody}}</p>
       <kbd>{{comment.author}}</kbd>
    {% endfor %}


<form  method="post" >
    {% csrf_token %}
   {{commentform}}
   <button type="submit" >Submit</button>
   </form>
<h1>answers</h1>

<ul>
    {% for answer in qdata.answers.all %}
    <li>{{ answer.body }} --<em id="up{{answer.id}}"> {{ answer.upvotes }}</em> <button onclick="upvote_update({{answer.id}},{{qdata.id}})">upvote</button>
        <em id="down{{answer.id}}">{{ answer.downvotes }} </em ><button onclick="downvote_update({{answer.id}},{{qdata.id}})">downvote</button>
        <em>{{ answer.author }}</em>
    </li>
    {% endfor %}
</ul>
<form  method="post" >
    {% csrf_token %}
   {{ansform}}
   <button type="submit" >Submit</button>
   </form>

<script>
	function upvote_update(answer_id,question_id){
    var btn = $("#up"+answer_id);

    $.ajax({
        url: '/q/upvote_route/',
        data: {
          'answer_id':answer_id,
          'question_id':question_id
        },
        dataType: 'json',
        success: function (data) {
          if (data)
           btn.text(data.votes);
        }
      });
	}
	function downvote_update(answer_id,question_id){
    var btn = $("#down"+answer_id);

    $.ajax({
        url: '/q/downvote_route/',
        data: {
          'answer_id':answer_id,
          'question_id':question_id
        },
        dataType: 'json',
        success: function (data) {
          if (data)
           btn.text(data.votes);
        }
      });
	}


</script>
{% endblock %}